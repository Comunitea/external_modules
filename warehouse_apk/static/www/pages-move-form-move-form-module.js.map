{"version":3,"sources":["./src/app/pages/move-form/move-form.page.html","./src/app/pages/move-form/move-form.module.ts","./src/app/pages/move-form/move-form.page.scss","./src/app/pages/move-form/move-form.page.ts"],"names":[],"mappings":"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","file":"pages-move-form-move-form-module.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-menu-button></ion-menu-button>\\n    </ion-buttons>\\n    <app-scanner-header slot=\\\"end\\\"></app-scanner-header>\\n    <ion-title>Movimiento</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n<ion-card *ngIf=\\\"data\\\">\\n\\n    <ion-card-header>\\n      <ion-card-title class=\\\"ion-text-center\\\">{{data.display_name}}</ion-card-title>\\n    </ion-card-header>\\n  \\n    <ion-card-content class=\\\"ion-text-center\\\">\\n      <div class=\\\"product_img\\\" class=\\\"ion-text-center\\\">\\n        <ion-img *ngIf=\\\"data.base64\\\" src=\\\"data:image/jpeg;base64,{{ data['image'] }}\\\" ></ion-img>\\n        <ion-img *ngIf=\\\"!data.base64\\\" src=\\\"{{ data['image'] }}\\\"></ion-img>\\n      </div>\\n      <div><strong>Pick: </strong>{{data.picking_id['id'] && data.picking_id['display_name']}}</div>\\n      <div><strong>Referencia: </strong>{{data.default_code}}</div>\\n      <div><strong>{{data.location_id['display_name']}} >> {{data.location_dest_id['display_name']}}</strong></div>\\n      <!-- <div [ngSwitch]=\\\"data.tracking\\\">\\n        <strong *ngSwitchCase=\\\"'none'\\\">Sin tracking</strong>\\n        <strong *ngSwitchCase=\\\"'lot'\\\">Por lotes</strong>\\n        <strong *ngSwitchCase=\\\"'serial'\\\">Por serie</strong>\\n      </div> -->\\n      <ion-row *ngIf=\\\"data.state != 'cancel' && data.state != 'done' && data.tracking=='none'\\\">\\n        <ion-col>\\n           <ion-badge class=\\\"link\\\" (click)=\\\"changeqty(-1)\\\"> - </ion-badge>\\n        </ion-col>\\n        <ion-col class=\\\"link\\\" (click)=\\\"changeqty(0)\\\"><strong>Cantidad: </strong><br/>\\n          <ion-badge class=\\\"primary\\\"> {{data.quantity_done}} de {{data.product_uom_qty}} </ion-badge> \\n        </ion-col>\\n        <ion-col>\\n          <ion-badge class=\\\"link\\\" (click)=\\\"changeqty(+1)\\\"> + </ion-badge>\\n        </ion-col>\\n      </ion-row>\\n\\n      <div *ngIf=\\\"data.state != 'cancel' && data.state != 'done' && data.tracking !='none'\\\">\\n        <div>\\n          <ion-badge class=\\\"primary\\\"> {{data.quantity_done}} de {{data.product_uom_qty}} </ion-badge> \\n        </div>\\n        <strong>Lotes/Serie:</strong>\\n        <div *ngFor=\\\"let lot of data.lot_ids\\\">\\n          {{lot.name}}\\n        </div>\\n      </div>\\n\\n      <div *ngIf=\\\"new_lots\\\">\\n        <strong>Añadiendo:</strong>\\n        <div *ngFor=\\\"let lot of new_lots\\\">\\n          {{lot[0]}}\\n        </div>\\n      </div>\\n\\n      <ion-row>\\n        <ion-col class=\\\"link\\\" (click)=\\\"get_move_info(data.id, -1)\\\">Anterior\\n        </ion-col>\\n        <!-- <ion-col *ngIf=\\\"data.ready_to_validate\\\" class=\\\"link\\\" (click)=\\\"button_validate(data.picking_id.id)\\\">Validar\\n        </ion-col> -->\\n        <ion-col class=\\\"link\\\" (click)=\\\"action_confirm()\\\">Confirmar\\n        </ion-col>\\n        <ion-col class=\\\"link\\\" (click)=\\\"get_move_info(data.id, +1)\\\">Siguiente\\n        </ion-col>\\n      </ion-row>\\n    </ion-card-content>\\n  \\n  </ion-card>\\n</ion-content>\\n\\n<app-scanner-footer (scanner_reading_changed)=\\\"onReadingEmitted($event)\\\" [scanner_reading]=\\\"scanner_reading\\\"></app-scanner-footer>\\n\\n<ng-template #lineDoneTemplate>\\n  <ion-col><strong>Cantidad: </strong><br/>\\n    <ion-badge class=\\\"secondary\\\"> {{data.quantity_done}} de {{data.product_uom_qty}} </ion-badge>\\n  </ion-col>\\n</ng-template>\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { MoveFormPage } from './move-form.page';\n\nimport { SharedModule } from '../../shared/shared.module';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: MoveFormPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes),\n    SharedModule\n  ],\n  declarations: [MoveFormPage]\n})\nexport class MoveFormPageModule {}\n","export default \"ion-img {\\n  max-width: 100px;\\n  max-height: 100px;\\n  margin-left: auto;\\n  margin-right: auto;\\n  width: 100px;\\n}\\n\\n.link {\\n  cursor: pointer;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2tpa28vaW9uaWM0L3dhcmVob3VzZV9tYW5hZ2VyX2Fwa18xMS9zcmMvYXBwL3BhZ2VzL21vdmUtZm9ybS9tb3ZlLWZvcm0ucGFnZS5zY3NzIiwic3JjL2FwcC9wYWdlcy9tb3ZlLWZvcm0vbW92ZS1mb3JtLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGdCQUFBO0VBQ0EsaUJBQUE7RUFDQSxpQkFBQTtFQUNBLGtCQUFBO0VBQ0EsWUFBQTtBQ0NKOztBREVBO0VBQ0ksZUFBQTtBQ0NKIiwiZmlsZSI6InNyYy9hcHAvcGFnZXMvbW92ZS1mb3JtL21vdmUtZm9ybS5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyJpb24taW1nIHtcbiAgICBtYXgtd2lkdGg6IDEwMHB4O1xuICAgIG1heC1oZWlnaHQ6IDEwMHB4O1xuICAgIG1hcmdpbi1sZWZ0OiBhdXRvO1xuICAgIG1hcmdpbi1yaWdodDogYXV0bztcbiAgICB3aWR0aDogMTAwcHg7XG59XG5cbi5saW5re1xuICAgIGN1cnNvcjogcG9pbnRlcjtcbn0iLCJpb24taW1nIHtcbiAgbWF4LXdpZHRoOiAxMDBweDtcbiAgbWF4LWhlaWdodDogMTAwcHg7XG4gIG1hcmdpbi1sZWZ0OiBhdXRvO1xuICBtYXJnaW4tcmlnaHQ6IGF1dG87XG4gIHdpZHRoOiAxMDBweDtcbn1cblxuLmxpbmsge1xuICBjdXJzb3I6IHBvaW50ZXI7XG59Il19 */\";","import { Component, OnInit, Input } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { Storage } from '@ionic/storage';\nimport { AlertController } from '@ionic/angular';\nimport { OdooService } from '../../services/odoo.service';\nimport { AudioService } from '../../services/audio.service';\nimport { StockService } from '../../services/stock.service';\nimport { Location } from \"@angular/common\";\nimport { LoadingController } from '@ionic/angular';\n\n\n@Component({\n  selector: 'app-move-form',\n  templateUrl: './move-form.page.html',\n  styleUrls: ['./move-form.page.scss'],\n})\nexport class MoveFormPage implements OnInit {\n\n  moves: any;\n  data: {};\n  placeholder: string;\n  move: BigInteger;\n  qty_done: BigInteger;\n  loading: any;\n  @Input() scanner_reading: string;\n  new_lots: any;\n\n  constructor(\n    private odoo: OdooService,\n    public router: Router,\n    public alertCtrl: AlertController,\n    private route: ActivatedRoute,\n    private audio: AudioService,\n    private stock: StockService,\n    private storage: Storage,\n    private location: Location,\n    public loadingController: LoadingController,\n  ) {\n    this.moves = ['up', 'down', 'left', 'right'];\n  }\n\n\n  ngOnInit() {\n    this.odoo.isLoggedIn().then((data) => {\n      if (data === false) {\n        this.router.navigateByUrl('/login');\n      } else {\n        this.storage.get('CONEXION').then((con) => {\n          this.placeholder = con.url + '/web/static/src/img/placeholder.png'\n        })\n        .catch((error) => {\n          this.presentAlert('Error al comprobar tu sesión:', error);\n        });\n        const move = +this.route.snapshot.paramMap.get('id');\n        this.get_move_info(move);\n      }\n    })\n    .catch((error) => {\n      this.presentAlert('Error al comprobar tu sesión:', error);\n    });\n  }\n\n  onReadingEmitted(val: string) {\n    if (this.moves.includes(val)) {\n      this.page_controller(val);\n    } else {\n      this.scanner_reading = val;\n      this.process_reading();\n    }\n  }\n\n  // Navigation \n\n  page_controller(direction) {\n    if (direction == 'up') {\n      console.log(\"up\");\n      this.router.navigateByUrl('/stock-picking/'+this.data['picking_id']['id']+'/'+this.data['picking_id']['code']);\n    } else if (direction == 'down') {\n      console.log(\"down\");\n      if (this.data['ready_to_validate']){\n        this.button_validate(this.data['picking_id']['id']);\n      } else {\n        this.action_confirm();\n      }\n    } else if (direction == 'left') {\n      console.log(\"left\");\n      this.get_move_info(this.data['id'], -1);\n    } else if (direction == 'right') {\n      console.log(\"right\");\n      this.get_move_info(this.data['id'], +1);\n    }\n  }\n\n  async presentAlert(titulo, texto) {\n    this.audio.play('error');\n    const alert = await this.alertCtrl.create({\n        header: titulo,\n        subHeader: texto,\n        buttons: ['Ok']\n    });\n    await alert.present();\n  }\n\n  changeqty(qty){\n    if (qty == 0) {\n      this.data['quantity_done'] = this.data['product_uom_qty'];\n    }\n    else{\n      this.data['quantity_done'] += qty;\n    }\n      \n  }\n\n  get_move_info(move, index=0) {\n    this.stock.get_move_info(move, index).then((data) => {\n      this.new_lots = false;\n      console.log(data);\n      if (data['image'] == false) {\n        data['base64'] = false;\n        data['image'] = this.placeholder;\n      } else {\n        data['base64'] = true;\n      }\n      this.data = data;\n      console.log(this.data);\n      this.audio.play('click');\n    })\n    .catch((error) => {\n      this.presentAlert('Error al recuperar el movimiento:', error);\n    });\n  }\n\n  action_confirm(){\n    if (this.data['tracking'] == 'none') {\n      this.stock.set_move_qty_done_from_apk(this.data['id'], this.data['quantity_done']).then((lines_data)=>{\n        console.log(lines_data);\n        this.get_move_info(this.data['id'], +1);\n      })\n      .catch((error)=>{\n        this.presentAlert('Error al validar el albarán:', error);\n      });\n    } else if (this.data['tracking'] != 'none' && this.new_lots){\n      this.update_lots();\n    }\n  }\n\n  button_validate(picking_id){\n    this.presentLoading();\n    this.stock.button_validate(Number(picking_id)).then((lines_data)=>{\n      if (lines_data && lines_data['err'] == false) {\n        console.log(\"Reloading\");\n        this.loading.dismiss()\n        this.location.back();\n      } else if (lines_data['err'] != false) {\n        this.loading.dismiss()\n        this.presentAlert('Error al validar el albarán:', lines_data['err']);\n      }\n    })\n    .catch((error)=>{\n      this.loading.dismiss()\n      this.presentAlert('Error al validar el albarán:', error);\n    });\n  }\n\n  async presentLoading() {\n    this.loading = await this.loadingController.create({\n      message: 'Validando...',\n      translucent: true,\n      cssClass: 'custom-class custom-loading'\n    });\n    await this.loading.present();\n  }\n\n  update_lots(){\n    this.stock.set_lot_ids_apk(this.data['id'], this.new_lots).then((lines_data)=>{\n      this.get_move_info(this.data['id']);\n    })\n    .catch((error)=>{\n      this.presentAlert('Error al validar el albarán:', error);\n    });\n  }\n\n  process_reading() {\n    if (this.data['tracking'] == 'none' && Number(this.scanner_reading)) {\n      this.data['quantity_done'] = Number(this.scanner_reading);\n    } else if (this.data['tracking'] != 'none') {\n      if(!this.new_lots){\n        this.new_lots = new Array();\n      }\n      this.new_lots.push([this.scanner_reading, 1]); /* Editar más adelante, serial cantidad = 1, lot cantidad = a introducir */\n      /* Provisional, cuando estén preparada la función para gestionar cantidades en lot_ids editar */\n      /* if (this.data['tracking'] == 'serial') { */\n      if (this.data['tracking'] == 'serial' || this.data['tracking'] == 'lot') {\n        this.data['quantity_done']++;\n      }\n    } \n  }\n\n}\n"],"sourceRoot":"webpack:///"}